<html>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="class.css">
    <body>
        
    <div class="header">
  <h2>üè´ ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á‡∏ä‡∏±‡πâ‡∏ô ‡∏°.4/2</h2>
</div>

<div class="controls">

  <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô...">
  <a href="index.html" class="button">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>

 
</div>
<table id="attendanceTable">
  <thead>
    <tr>
      <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
      <th>‡∏ä‡∏∑‡πà‡∏≠</th>
      <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
      <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
    </tr>
  </thead>
  <tbody>
   <tr><td>1</td><td>‡∏ô‡∏≤‡∏¢ ‡∏™‡∏∏‡∏ä‡∏±‡∏à‡∏à‡πå ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td><td><select><option>‚úÖ ‡∏°‡∏≤</option><option>‚ùå ‡∏Ç‡∏≤‡∏î</option><option>üìù ‡∏•‡∏≤</option><option>‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</option></select></td><td><input type="text" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏..."></td></tr>
<tr><td>2</td><td>‡∏ô‡∏≤‡∏¢ ‡∏Å‡∏ô‡∏Å‡∏ä‡∏≤‡∏ç ‡∏£‡∏≤‡∏ä‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå</td><td><select><option>‚úÖ ‡∏°‡∏≤</option><option>‚ùå ‡∏Ç‡∏≤‡∏î</option><option>üìù ‡∏•‡∏≤</option><option>‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</option></select></td><td><input type="text" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏..."></td></tr>
<tr><td>3</td><td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏û‡∏µ‡∏£‡∏∞‡∏†‡∏±‡∏ó‡∏£ ‡∏ä‡∏±‡∏¢‡∏ä‡∏ô‡∏∞</td><td><select><option>‚úÖ ‡∏°‡∏≤</option><option>‚ùå ‡∏Ç‡∏≤‡∏î</option><option>üìù ‡∏•‡∏≤</option><option>‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</option></select></td><td><input type="text" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏..."></td></tr>
<tr><td>4</td><td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏ô‡∏§‡πÄ‡∏ô‡∏ï‡∏£ ‡∏¢‡∏ß‡∏ô‡∏ô‡∏≤</td><td><select><option>‚úÖ ‡∏°‡∏≤</option><option>‚ùå ‡∏Ç‡∏≤‡∏î</option><option>üìù ‡∏•‡∏≤</option><option>‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</option></select></td><td><input type="text" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏..."></td></tr>
<tr><td>5</td><td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏õ‡∏≤‡∏ì‡∏¥‡∏™‡∏£‡∏≤ ‡∏®‡∏¥‡∏£‡∏¥‡∏£‡∏±‡∏°‡∏¢‡πå</td><td><select><option>‚úÖ ‡∏°‡∏≤</option><option>‚ùå ‡∏Ç‡∏≤‡∏î</option><option>üìù ‡∏•‡∏≤</option><option>‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</option></select></td><td><input type="text" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏..."></td></tr>
<tr><td>6</td><td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏ô‡∏†‡∏≤‡∏ß‡∏£‡∏£‡∏ì ‡∏®‡∏±‡∏Å‡∏î‡∏≤</td><td><select><option>‚úÖ ‡∏°‡∏≤</option><option>‚ùå ‡∏Ç‡∏≤‡∏î</option><option>üìù ‡∏•‡∏≤</option><option>‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</option></select></td><td><input type="text" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏..."></td></tr>







  </tbody>
</table>

<div class="controls">
<button onclick="exportTableToExcel()">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å Excel</button>
<button onclick="saveToGoogleSheet()">üì§ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheet</button>

</div>
<script>
  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô toggle ‡∏ó‡∏µ‡∏•‡∏∞‡∏õ‡∏∏‡πà‡∏° (‡πÄ‡∏î‡∏¥‡∏°)
  document.querySelectorAll('.status-button').forEach(button => {
    button.addEventListener('click', () => {
      if (button.classList.contains('status-present')) {
        button.classList.remove('status-present');
        button.classList.add('status-absent');
        button.textContent = '‚ùå ‡∏Ç‡∏≤‡∏î';
      } else {
        button.classList.remove('status-absent');
        button.classList.add('status-present');
        button.textContent = '‚úÖ ‡∏°‡∏≤';
      }
    });
  });

</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
function exportTableToExcel() {
  const table = document.querySelector("#attendanceTable");
  const rows = table.querySelectorAll("tbody tr");

  const data = [["‡∏•‡∏≥‡∏î‡∏±‡∏ö", "‡∏ä‡∏∑‡πà‡∏≠ - ‡∏™‡∏Å‡∏∏‡∏•", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞", "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏"]];

  rows.forEach(row => {
    const index = row.querySelector("td:nth-child(1)").textContent.trim();
    const name = row.querySelector("td:nth-child(2)").textContent.trim();
    const status = row.querySelector("select")?.value || "";
    const note = row.querySelector("input")?.value || "";
    data.push([index, name, status, note]);
  });

  const worksheet = XLSX.utils.aoa_to_sheet(data);
  const workbook = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(workbook, worksheet, "‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠");

  XLSX.writeFile(workbook, "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠ ‡∏°.4/2.xlsx");
}
async function saveToGoogleSheet() {
  // **‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢ Web app URL ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Apps Script Deploy**
  const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxGUaaFzNmw6xoHR3yWUSJgGeKrgtgUX8-ryIhNuZdPvzJYpgEN6bAPKJeIB6DkjAjp/exec'; 

  const table = document.querySelector("#attendanceTable");
  const rows = table.querySelectorAll("tbody tr");

  const dataToSave = [];
  rows.forEach(row => {
    const index = row.querySelector("td:nth-child(1)").textContent.trim();
    const name = row.querySelector("td:nth-child(2)").textContent.trim();
    const status = row.querySelector("select")?.value || "";
    const note = row.querySelector("input")?.value || "";
    dataToSave.push({ index, name, status, note });
  });

  try {
    const response = await fetch(WEB_APP_URL, {
      method: 'POST',
      mode: 'no-cors', // ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Apps Script ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á CORS error
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(dataToSave),
    });

    // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÉ‡∏ä‡πâ 'no-cors' mode, response.json() ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏á‡πÜ
    // ‡πÅ‡∏ï‡πà Apps Script ‡∏à‡∏∞‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ
    alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheet ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');

  } catch (error) {
    console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error);
    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•. ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Apps Script ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì');
  }
}
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
// ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
document.querySelector('input[placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô..."]').addEventListener('input', function() {
  const searchText = this.value.toLowerCase();
  const rows = document.querySelectorAll("#attendanceTable tbody tr");

  rows.forEach(row => {
    const name = row.querySelector("td:nth-child(2)").textContent.toLowerCase();
    if (name.includes(searchText)) {
      row.style.display = "";
    } else {
      row.style.display = "none";
    }
  });
});
</script>


</body>
</html>